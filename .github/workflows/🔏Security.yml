
name: 🔏Security
on:
  workflow_dispatch:
  workflow_call:

jobs:
  Bandit:
    permissions:
      contents: read # for actions/checkout to fetch code
      security-events: write # for github/codeql-action/upload-sarif to upload SARIF results
      actions: read # only required for a private repository by github/codeql-action/upload-sarif to get the Action run status

    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Bandit Scan
        uses: shundor/python-bandit-scan@9cc5aa4a006482b8a7f91134412df6772dbda22c
        with: # optional arguments
          exit_zero: true # optional, default is DEFAULT
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Needed to get PR information.
          excluded_paths: "tests" # optional, default is DEFAULT

      # - name: Run bandit
      #   run: >
      #     pip install bandit
      #     bandit -c bandit.toml -r boom

  # GitGuardian:
  #   name: GitGuardian Scanning
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v3.5.2
  #       with:
  #         fetch-depth: 0 # fetch all history so multiple commits can be scanned
  #     - name: GitGuardian scan
  #       uses: GitGuardian/ggshield-action@v1.15.0
  #       env:
  #         GITHUB_PUSH_BEFORE_SHA: ${{ github.event.before }}
  #         GITHUB_PUSH_BASE_SHA: ${{ github.event.base }}
  #         GITHUB_PULL_BASE_SHA:  ${{ github.event.pull_request.base.sha }}
  #         GITHUB_DEFAULT_BRANCH: ${{ github.event.repository.default_branch }}
  #         GITGUARDIAN_API_KEY: ${{ secrets.GITGUARDIAN_API_KEY }}